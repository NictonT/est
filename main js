// Configuration
const CONFIG = {
    // Google Docs published URL
    docsUrl: 'https://docs.google.com/document/d/e/2PACX-1vTwkALtdtu63ywmjotmY_pDohbrq4AqaO4VgBR2nO_eFDGil7upciaDH-idDLZAphJ9MHEeptzpjlP6/pub',
    documentsPerPage: 1, // Changed to 1 since we're showing the full document
    paths: {
        placeholderImage: 'images/placeholder-doc.png'
    }
};

// State management
const state = {
    documentContent: null,
};

// DOM Elements
const elements = {
    documentsContainer: document.getElementById('documentsContainer'),
    loadingIndicator: document.getElementById('loadingIndicator')
};

// Initialize application
document.addEventListener('DOMContentLoaded', () => {
    loadDocument();
});

// Document Loading
function loadDocument() {
    showLoading(true);
    
    // Use fetch with no-cors mode to get the document
    fetch(CONFIG.docsUrl)
        .then(response => response.text())
        .then(html => {
            // Parse the Google Docs HTML content
            const parser = new DOMParser();
            const doc = parser.parseFromString(html, 'text/html');
            
            // Extract and display document content
            displayDocument(doc);
            showLoading(false);
        })
        .catch(error => {
            console.error('Error loading document:', error);
            showError('Failed to load document. Please try again later.');
            showLoading(false);
        });
}

function displayDocument(doc) {
    // Get the main content div
    const content = doc.querySelector('.doc-content') || doc.body;
    
    if (!content) {
        showError('No content found in the document.');
        return;
    }

    // Create a container for the document
    elements.documentsContainer.innerHTML = `
        <div class="document-container bg-white shadow-sm rounded p-4">
            ${content.innerHTML}
        </div>
    `;

    // Apply additional styling to the content
    styleDocument();
}

function styleDocument() {
    // Add styling to make the document look more like Google Docs
    const style = document.createElement('style');
    style.textContent = `
        .document-container {
            max-width: 800px;
            margin: 0 auto;
            font-family: Arial, sans-serif;
            line-height: 1.6;
            color: #333;
        }

        .document-container h1 {
            font-size: 2.25rem;
            margin-bottom: 1.5rem;
            color: #202124;
        }

        .document-container h2 {
            font-size: 1.75rem;
            margin-top: 2rem;
            margin-bottom: 1rem;
            color: #202124;
        }

        .document-container p {
            margin-bottom: 1rem;
        }

        .document-container img {
            max-width: 100%;
            height: auto;
            margin: 1rem 0;
        }

        .document-container table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        .document-container table td,
        .document-container table th {
            border: 1px solid #e0e0e0;
            padding: 0.5rem;
        }

        .document-container ul,
        .document-container ol {
            margin-bottom: 1rem;
            padding-left: 2rem;
        }

        @media print {
            .document-container {
                box-shadow: none !important;
            }
        }
    `;
    document.head.appendChild(style);
}

// Utility Functions
function showLoading(show) {
    elements.loadingIndicator.style.display = show ? 'block' : 'none';
}

function showError(message) {
    elements.documentsContainer.innerHTML = `
        <div class="alert alert-danger">
            <i class="fas fa-exclamation-circle me-2"></i>${message}
        </div>
    `;
}
